{% extends "base.html" %}
{% block footjs %}
	<script>
	$(function () {
	  $('[data-toggle="tooltip"]').tooltip()
	})
	</script>
{% endblock %}
{% block content %}
<div class="well"  style="margin-top:15px;">
	<h2 style="margin-top:10px;">{{project.name}}</h2>
	<p>
	{{project.description}}
	</p>
</div>
	<div class="row">
		<div class="col-md-7 col-sm-7">

			<div class="panel panel-default">
				<div class="panel-heading"><strong>Users already participating in this fieldwork project</strong></div>
				<div class="panel-body">
					<p>
					The following users are participating in this project.
					</p>
				</div>
				<div class="panel-body" style="padding:0;">
			
			<table class="table table-condensed">
			<thead>
			<tr><th>Username</th><th>Full name</th><th>E-mail</th><th></th></tr>
			</thead>
			<tbody>
			{% for user in users %}
			<tr>
				<td><code>{{user.username}}</code></td>
				<td>
					{{user.fullname}}
						{% if user.is_supervisor or user.is_admin %}
							<i data-original-title="This user is a supervisor or administrator" data-toggle="tooltip" title="" class="fa fa-graduation-cap"></i>
						{% endif %}
				</td>
				<td>
					{{user.email}}
				</td>
				<td style="text-align:right;">
					{% for role in user.roles %}
						{% if role.name=="student" %}
						{% else %}
						{% endif %}
					{% endfor %}
					{% if user.is_student %}
					<a class="btn btn-primary btn-xs" href="/projects/{{project.slug}}/{{user.id}}/maps">View maps <i class="fa fa-search"></i></a>
					{% endif %}
				</td>
			</tr>
			{% endfor %}
			</tbody>
			</table>

				</div>
			</div>


			<div class="panel panel-default">
				<div class="panel-heading">
					<strong>Enroll new users</strong> <!--<a href="#" class="pull-right">View Project Basemap</a>-->
				</div>
				<div class="panel-body">
				<p>
					The invitation key/password for this project is <code>{{project.invite_key}}</code>. When students sign up and enter this key they will be automatically enrolled in this fieldwork campaign.
					It is also possible to manually enroll users. Below is a list of users which are not enrolled in this project. You can quickly enroll them by clicking the 'enroll' button.
				</p>

				</div>
				<div class="panel-body" style="padding:0;">
<table class="table table-condensed">
			<thead>
			<tr><th>Username</th><th>Full name</th><th>E-mail</th><th></th></tr>
			</thead>
			<tbody>
			{% for user in enrollable_users %}
			<tr>
				<td><code>{{user.username}}</code></td>
				<td>
					{{user.fullname}}
						{% if user.is_supervisor or user.is_admin %}
							<i data-original-title="This user is a supervisor or administrator" data-toggle="tooltip" title="" class="fa fa-graduation-cap"></i>
						{% endif %}
				</td>
				<td>
					{{user.email}}
				</td>
				<td style="text-align:right;">
					<a class="btn btn-primary btn-xs" href="/projects/{{project.slug}}/{{user.id}}/enroll"><i class="fa fa-plus"></i> Enroll</a>
				</td>
			</tr>
			{% endfor %}
			</tbody>
			</table>
				</div>
			
			</div>
		</div>
		<div class="col-md-5 col-sm-5">
			<div class="panel panel-default">
				<div class="panel-heading">
					<strong>Upload new base map files</strong>
				</div>
				<div class="panel-body">
					<form role="form" action="map" method="post" enctype="multipart/form-data">
					<div class="form-group">
						<input type="file" name="uploadfile">
					</div>
					<button type="submit" class="btn btn-default btn-xs">Upload file <i class="fa fa-long-arrow-right"></i></button>
					<button type="submit" class="btn btn-default btn-xs">Clear all uploads <i class="fa fa-times"></i>
					</form>
				</div>
			</div>

			{% if current_user.is_student %}
			<div class="panel panel-default">
				<div class="panel-heading">
					<strong>My Fieldwork Data</strong>
				</div>
				<div class="panel-body">
				<a href="/projects/{{project.slug}}/{{current_user.id}}">Your maps and data are in your project directory</a>
				</div>
			</div>
			{% endif %}

			{% if current_user.id %}
			<div class="panel panel-default">
				<div class="panel-heading">
					<strong>Quick Upload Data</strong>
				</div>
				<div class="panel-body">
				Drag and drop files into this box to upload them to your project data.
				</div>
			</div>
			{% endif %}

		</div>
	</div>
	



	
{% endblock %}

{% block map %}
<!--
<div style="top:70px;width:100%;height:500px;">
<iframe height="100%" width="100%" frameborder="0" style="width:100%;height:100%;border:none;" src="http://qgis-web-client.localhost/qgiswebclient.html?map=/var/qgis-web-client/projects/testproject.qgs"></iframe>
</div>-->
{% endblock %}